package com {		import com.caurina.transitions.Tweener;	import com.caurina.transitions.properties.ColorShortcuts;	import flash.display.*;	import flash.text.*;	import flash.events.*;	import flash.net.*;	import flash.utils.*;	ColorShortcuts.init();			public class Main extends MovieClip{						var bknd:MovieClip;			var navCirc:Circle;			var mainNavContainer:MovieClip = new MovieClip();			var subNavContainer:MovieClip = new MovieClip();			var mainImgContainer:MovieClip = new MovieClip();			var subCount:int;			var subCirc:subNavCircle;			var alphaFadeIn:Number;			var iMask:imageMask = new imageMask();			var clickURL:String						var homeUrl:String = "http://jennykdesign.com/review/intro/";			var designUrl:String = "http://www.jennykdesign.com";			var illustrationUrl:String = "http://www.stompweb.com";			var photographyUrl:String = "http://www.jennykdesign.com";			var experienceUrl:String = "http://www.stompweb.com";			var contactUrl:String = "http://www.jennykdesign.com";			var sevaUrl:String = "http://www.stompweb.com";						var jkTxt:MovieClip;			var designNav:MovieClip;			var illNav:MovieClip;			var photoNav:MovieClip;			var expNav:MovieClip;			var contactNav:MovieClip;			var sevaNav:MovieClip;			var back_BTN:MovieClip;			var forward_BTN:MovieClip;									var imageLoader:Loader = new Loader();			var activeSection:Number;			var activeSubSection:Number;			var paragraphCount:Number;			var navYCo:Number;			var activeSubNavDisplay:Object;			var activeNavDisplay:Object;			var activeCategory:String;			var totalCategories:Number;			var activeCategoryFade:MovieClip;			var aboutTxt:TextField;			var circNum:TextField;			var startImage:XMLList;			var xml:XML;			var xmlLoader:URLLoader = new URLLoader();			public function Main(xmlURL){						var xmlReq:URLRequest = new URLRequest(xmlURL);						xmlLoader.dataFormat = URLLoaderDataFormat.TEXT;			xmlLoader.addEventListener(Event.COMPLETE,xmlLoaded);			xmlLoader.load(xmlReq);						//illustration			activeCategory = "design";			//activeCategory = "photography";			activeCategoryFade = designNav;			//activeCategoryFade = photoNav;			activeSection = 1;						subNavContainer.x = 77;			subNavContainer.y = 375;			mainImgContainer.x = 447;			mainImgContainer.y = 303;						// Fade Stuff			alphaFadeIn = 1;									// Navigation Alpha			//aboutNav.alpha = 100;			jkTxt.alpha = 100;			illNav.alpha = 100;			photoNav.alpha = 100;			expNav.alpha = 100;			contactNav.alpha = 100;			sevaNav.alpha = 100;			back_BTN.alpha = 0;						Tweener.addTween(activeCategoryFade, {_color:0xFFFFFF, time:1, delay:0, transition:"linear"});						// Main Content			aboutTxt.alpha = 1;						// NEW================================================BELOW						function xmlLoaded(event:Event):void			{				xml = new XML(event.target.data);								loadMainNav(xml);				loadSubNav(xml);				//Tweener.addTween(imageLoader, {alpha:1, time:.5, delay:.5, transition:"linear"});				Tweener.addTween(subCirc, {alpha:1, time:.5, delay:.5, transition:"linear"});				}						function loadMainNav(navData:XML):void			{				var j:int = 0;								for each ( var child:XML in navData.section.(@title == activeCategory).(@title == activeCategory))				{					navYCo = navData.section.(@title == activeCategory).@navY;					//trace("navYCo: "+navYCo);					mainNavContainer.y = navYCo;					mainNavContainer.x = 510;					addChild(mainNavContainer);					//var navArray:Array = new Array();										for each (var sectItems:XML in child.item)					{						j++;						//trace(child);						navCirc = new Circle();						circNum = new TextField();						navCirc.x = 0 +30*j;						//navCirc.y = navYCo;						circNum.x = navCirc.x;						circNum.y = navCirc.y;						navCirc.addEventListener(MouseEvent.CLICK, circNavClick);						navCirc.addEventListener(MouseEvent.MOUSE_OVER, circNavOver);						navCirc.addEventListener(MouseEvent.MOUSE_OUT, circNavOut);						navCirc.buttonMode = true;						navCirc.useHandCursor = true;						navCirc.mouseChildren = false;						navCirc.id = j;						navCirc.name = "navCirc"+[j];												mainNavContainer.addChild(navCirc);						trace("navCirc.name: "+navCirc.name);						navCirc.circNum.htmlText = navCirc.id;						totalCategories = j;							}							}								activeNavDisplay = mainNavContainer.getChildAt(activeSection-1);				activeNavDisplay.gotoAndStop("over");				trace("activeNavDisplay: "+activeNavDisplay);				aboutTxt.htmlText = child.item.(@id == activeSection).copy;				//trace("aboutTxt.length: "+aboutTxt.length);				startImage = child.item.(@id == activeSection).image[0].@source;				iMask.x = 447;				iMask.y = 303;				imageLoader.load(new URLRequest(startImage));							imageLoader.mask = iMask;				imageLoader.alpha = 0;				mainImgContainer.addChild(imageLoader);				//trace("paragraphCount: "+paragraphCount);								addChild(mainImgContainer);				imageLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, fadeImage);			}						function loadSubNav(subNavData:XML):void			{				var i:int = 0;								for each (var subNav:XML in subNavData.section.(@title == activeCategory).item.(@id == activeSection).image)					{						trace("activeSection: "+activeSection);						i++;						subCirc = new subNavCircle();						subCirc.x = 0+18*i;						paragraphCount = subNavData.section.(@title == activeCategory).item.(@id == activeSection).@p;						subCirc.y = paragraphCount;						subCirc.buttonMode = true;						subCirc.useHandCursor = true;						subCirc.addEventListener(MouseEvent.MOUSE_OVER, subCircNavOver);						subCirc.addEventListener(MouseEvent.MOUSE_OUT, subCircNavOut);						subCirc.addEventListener(MouseEvent.CLICK, subCircNavClick);						subCirc.name = "subCirc"+[i];						subCirc.id = i;						subNavContainer.addChild(subCirc);						subCount = subNavContainer.numChildren;						//trace("numChildren: = "+subCount);					}					addChild(subNavContainer);					activeSubNavDisplay = subNavContainer.getChildAt(activeSubSection-1);					activeSubNavDisplay.gotoAndStop("over");			}						function circNavOver(e:Event):void{				//trace(e.target.name);								e.target.gotoAndStop("over");			}			function circNavOut(e:Event):void{				e.target.gotoAndStop("up");				activeNavDisplay.gotoAndStop("over");			}			function subCircNavOver(e:Event):void{				//trace(e.target.name);				e.target.gotoAndStop("over");			}			function subCircNavOut(e:Event):void{				e.target.gotoAndStop("up");				activeSubNavDisplay.gotoAndStop("over");			}			function fadeImage(e:Event):void			{				Tweener.addTween(imageLoader, {alpha:1, time:.4, delay:0, transition:"linear"});				}			function resetActiveNav():void			{				activeSubNavDisplay.gotoAndStop("up");				activeNavDisplay.gotoAndStop("up");				activeSubNavDisplay = subNavContainer.getChildAt(activeSubSection-1);				activeNavDisplay = mainNavContainer.getChildAt(activeSection-1);				activeNavDisplay.gotoAndStop("over");				activeSubNavDisplay.gotoAndStop("over");			}			function circNavClick(e:Event):void{				e.target.gotoAndStop("over");				activeSubSection = 1;				var nextImg:Number = e.target.id;				Tweener.addTween(imageLoader, {alpha:0, time:.4, delay:0, transition:"linear", onComplete:swapImage, onCompleteParams:[nextImg,0]});			}			function subCircNavClick(e:Event):void{					//trace(e.target.id);				var nextImg:Number = e.target.id-1;				//Tweener.addTween(imageLoader, {alpha:0, time:.4, delay:0, transition:"linear", onComplete:swapImage, onCompleteParams:[e,2]});				Tweener.addTween(imageLoader, {alpha:0, time:.4, delay:0, transition:"linear", onComplete:subSwapImage, onCompleteParams:[e,nextImg]});				}			function subSwapImage(e:Event,n:Number):void			{				activeSubSection = xml.section.item.(@id == activeSection).image[n].@id;				imageLoader.load(new URLRequest(xml.section.item.(@id == activeSection).image[n].@source));				imageLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, fadeImage);				resetActiveNav();			}			function swapImage(e:Number,n:Number):void			{				//navYCo = xml.section[e].@navY;				//navCirc.y = navYCo;				paragraphCount = xml.section.(@title == activeCategory).item.(@id == activeSection).@p;				subCirc.y = paragraphCount;				trace(paragraphCount);				imageLoader.load(new URLRequest(xml.section.(@title == activeCategory).item.(@id == e).image[n].@source));				aboutTxt.htmlText = xml.section.(@title == activeCategory).item.(@id == e).copy;				activeSection = xml.section.(@title == activeCategory).item.(@id == e).@id;				resetActiveNav();				clearSubNav(subCount);				loadSubNav(xml);				imageLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, fadeImage);				trace("activeSection: "+activeSection);								if (activeSection >= totalCategories)				{					Tweener.addTween(forward_BTN, {alpha:0, time:.5, delay:0, transition:"linear"});					}				if (activeSection < totalCategories)				{					Tweener.addTween(forward_BTN, {alpha:1, time:.5, delay:0, transition:"linear"});					}				if (activeSection < 2)				{					Tweener.addTween(back_BTN, {alpha:0, time:.5, delay:0, transition:"linear"});					}				if (activeSection > 1)				{					Tweener.addTween(back_BTN, {alpha:1, time:.5, delay:0, transition:"linear"});					}			}			function fwdButton(e:Event):void			{				if (activeSection < totalCategories){					activeSubSection = 1;					var nextImg:Number = activeSection+1;					Tweener.addTween(imageLoader, {alpha:0, time:.4, delay:0, transition:"linear", onComplete:swapImage, onCompleteParams:[nextImg,0]});					}			}			function bckButton(e:Event):void			{				if (activeSection >1){					activeSubSection = 1;					var nextImg:Number = activeSection-1;					Tweener.addTween(imageLoader, {alpha:0, time:.4, delay:0, transition:"linear", onComplete:swapImage, onCompleteParams:[nextImg,0]});					}			}						function clearSubNav(subCount:int):void			{				//trace ('before : '+subNavContainer.numChildren);					while( subCount -- )				{					subNavContainer.removeChildAt( subCount );				}					//trace ('after : '+subNavContainer.numChildren);			}			back_BTN.addEventListener(MouseEvent.CLICK, bckButton);			back_BTN.buttonMode = true;			back_BTN.useHandCursor = true;			forward_BTN.addEventListener(MouseEvent.CLICK, fwdButton);			forward_BTN.buttonMode = true;			forward_BTN.useHandCursor = true;			jkTxt.addEventListener(MouseEvent.MOUSE_OVER, navOver);			jkTxt.addEventListener(MouseEvent.MOUSE_OUT, navOut);			jkTxt.addEventListener(MouseEvent.CLICK, navClick);			jkTxt.buttonMode = true;			illNav.useHandCursor = true;			illNav.addEventListener(MouseEvent.MOUSE_OVER, navOver);			illNav.addEventListener(MouseEvent.MOUSE_OUT, navOut);			illNav.addEventListener(MouseEvent.CLICK, navClick);			illNav.buttonMode = true;			illNav.useHandCursor = true;			photoNav.addEventListener(MouseEvent.MOUSE_OVER, navOver);			photoNav.addEventListener(MouseEvent.MOUSE_OUT, navOut);			photoNav.addEventListener(MouseEvent.CLICK, navClick);			photoNav.buttonMode = true;			photoNav.useHandCursor = true;			expNav.addEventListener(MouseEvent.MOUSE_OVER, navOver);			expNav.addEventListener(MouseEvent.MOUSE_OUT, navOut);			expNav.addEventListener(MouseEvent.CLICK, navClick);			expNav.buttonMode = true;			expNav.useHandCursor = true; 			contactNav.addEventListener(MouseEvent.MOUSE_OVER, navOver);			contactNav.addEventListener(MouseEvent.MOUSE_OUT, navOut);			contactNav.addEventListener(MouseEvent.CLICK, navClick);			contactNav.buttonMode = true;			contactNav.useHandCursor = true;			sevaNav.addEventListener(MouseEvent.MOUSE_OVER, navOver);			sevaNav.addEventListener(MouseEvent.MOUSE_OUT, navOut);			sevaNav.addEventListener(MouseEvent.CLICK, navClick);			sevaNav.buttonMode = true;			sevaNav.useHandCursor = true;									function navOver(e:Event):void {				trace(e.target.name);				Tweener.addTween(e.target, {_color:0xFFFFFF, time:.5, delay:0, transition:"linear"});							}			function navOut(e:Event):void {				if (e.target.name == "jkTxt")				{					Tweener.addTween(e.target, {_color:0xEC008C, time:.5, delay:0, transition:"linear"});					}				else {					Tweener.addTween(e.target, {_color:0x6B3000, time:.5, delay:0, transition:"linear"});				}						}			function navClick(e:Event):void {				switch (e.target.name) {					case "jkTxt" :						navigateToURL(new URLRequest(homeUrl),"_self");						break;					case "designNav" :						navigateToURL(new URLRequest(designUrl),"_self");						break;					case "illNav" :						navigateToURL(new URLRequest(illustrationUrl),"_self");						break;					case "photoNav" :						navigateToURL(new URLRequest(photographyUrl),"_self");						break;					case "expNav" :						navigateToURL(new URLRequest(experienceUrl),"_self");						break;					case "contactNav" :						navigateToURL(new URLRequest(contactUrl),"_self");						break;					case "sevaNav" :						navigateToURL(new URLRequest(sevaUrl),"_self");						break;				}						}		}			}}